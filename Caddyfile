:{$PORT}

root * /app/dist

file_server

# Configurar MIME types corretos
@js {
    path *.js
}
header @js Content-Type "application/javascript; charset=utf-8"

@css {
    path *.css
}
header @css Content-Type "text/css; charset=utf-8"

@wasm {
    path *.wasm
}
header @wasm Content-Type "application/wasm"

# SPA fallback - todas as rotas retornam index.html
try_files {path} /index.html

# Headers de seguran√ßa e cache
header {
    # Security headers
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    X-XSS-Protection "1; mode=block"
    
    # Cache headers
    Cache-Control "public, max-age=31536000, immutable" @js
    Cache-Control "public, max-age=31536000, immutable" @css
}

# Comprimir respostas
encode gzip

log {
    output stdout
    format json
}

